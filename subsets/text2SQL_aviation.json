{
    "queries": [
        {
            "question": "Какие пассажиры имеют более 2 подтвержденных бронирований?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(b.BookingID) AS TotalBookings\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nWHERE b.Status = 'Подтверждено'\nGROUP BY p.FirstName, p.LastName\nHAVING COUNT(b.BookingID) > 2;"
        },
        {
            "question": "Какие модели самолетов имеют среднюю стоимость технического обслуживания более 20000?",
            "sql_query": "SELECT a.Model, AVG(m.Cost) AS AvgMaintenanceCost\nFROM Aircraft a\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nGROUP BY a.Model\nHAVING AVG(m.Cost) > 20000;"
        },
        {
            "question": "Какие аэропорты имеют более 3 запланированных вылетов?",
            "sql_query": "SELECT ap.Name AS AirportName, COUNT(f.FlightID) AS TotalDepartures\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nWHERE f.Status = 'Запланирован'\nGROUP BY ap.Name\nHAVING COUNT(f.FlightID) > 3;"
        },
        {
            "question": "Какие авиакомпании имеют общую выручку от подтвержденных бронирований более 5000?",
            "sql_query": "SELECT al.Name AS AirlineName, SUM(b.Price) AS TotalRevenue\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Booking b ON f.FlightID = b.FlightID\nWHERE b.Status = 'Подтверждено'\nGROUP BY al.Name\nHAVING SUM(b.Price) > 5000;"
        },
        {
            "question": "Какие модели самолетов имеют более 2 запланированных рейсов?",
            "sql_query": "SELECT a.Model, COUNT(f.FlightID) AS TotalFlights\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nWHERE f.Status = 'Запланирован'\nGROUP BY a.Model\nHAVING COUNT(f.FlightID) > 2;"
        },
        {
            "question": "Какие авиакомпании имеют более 3 пилотов с опытом работы более 10 лет?",
            "sql_query": "SELECT al.Name AS AirlineName, COUNT(p.PilotID) AS TotalPilots\nFROM Airline al\nJOIN Pilot p ON al.AirlineID = p.AirlineID\nWHERE p.ExperienceYears > 10\nGROUP BY al.Name\nHAVING COUNT(p.PilotID) > 3;"
        },
        {
            "question": "Какие аэропорты имеют более 5 успешных проверок безопасности?",
            "sql_query": "SELECT ap.Name AS AirportName, COUNT(sc.SecurityCheckID) AS TotalSecurityChecks\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN SecurityCheck sc ON b.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Прошел'\nGROUP BY ap.Name\nHAVING COUNT(sc.SecurityCheckID) > 5;"
        },
        {
            "question": "Какие пассажиры имеют более 1 неуспешной проверки безопасности?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(sc.SecurityCheckID) AS TotalSecurityChecks\nFROM Passenger p\nJOIN SecurityCheck sc ON p.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Не прошел'\nGROUP BY p.FirstName, p.LastName\nHAVING COUNT(sc.SecurityCheckID) > 1;"
        },
        {
            "question": "Какие модели самолетов имеют более 2 завершенных технических обслуживаний?",
            "sql_query": "SELECT a.Model, COUNT(m.MaintenanceID) AS TotalMaintenances\nFROM Aircraft a\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nGROUP BY a.Model\nHAVING COUNT(m.MaintenanceID) > 2;"
        },
        {
            "question": "Какие авиакомпании имеют более 10 принятых единиц багажа?",
            "sql_query": "SELECT al.Name AS AirlineName, COUNT(bg.BaggageID) AS TotalBaggage\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Принято'\nGROUP BY al.Name\nHAVING COUNT(bg.BaggageID) > 10;"
        },
        {
            "question": "Какие пассажиры потратили более 3000 на подтвержденные бронирования?",
            "sql_query": "SELECT p.FirstName, p.LastName, SUM(b.Price) AS TotalSpent\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nWHERE b.Status = 'Подтверждено'\nGROUP BY p.FirstName, p.LastName\nHAVING SUM(b.Price) > 3000;"
        },
        {
            "question": "Какие модели самолетов имеют среднюю продолжительность рейса более 120 минут?",
            "sql_query": "SELECT a.Model, AVG(f.DurationMinutes) AS AvgFlightDuration\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nWHERE f.Status = 'Запланирован'\nGROUP BY a.Model\nHAVING AVG(f.DurationMinutes) > 120;"
        },
        {
            "question": "Какие авиакомпании имеют среднюю стоимость технического обслуживания более 15000?",
            "sql_query": "SELECT al.Name AS AirlineName, AVG(m.Cost) AS AvgMaintenanceCost\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nGROUP BY al.Name\nHAVING AVG(m.Cost) > 15000;"
        },
        {
            "question": "Какие пилоты были командирами экипажа более чем в 2 рейсах?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(c.CrewID) AS TotalFlightsAsCaptain\nFROM Pilot p\nJOIN Crew c ON p.PilotID = c.PilotID\nWHERE c.Role = 'Командир экипажа'\nGROUP BY p.FirstName, p.LastName\nHAVING COUNT(c.CrewID) > 2;"
        },
        {
            "question": "Какие модели самолетов имеют более 3 подтвержденных бронирований?",
            "sql_query": "SELECT a.Model, COUNT(b.BookingID) AS TotalBookings\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nWHERE b.Status = 'Подтверждено'\nGROUP BY a.Model\nHAVING COUNT(b.BookingID) > 3;"
        },
        {
            "question": "Какие аэропорты имеют среднее время проверки безопасности менее 12:00 и более 2 проверок?",
            "sql_query": "SELECT ap.Name AS AirportName, AVG(sc.CheckTime) AS AvgSecurityCheckTime\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN SecurityCheck sc ON b.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Прошел' AND CAST(sc.CheckTime AS TIME) < '12:00:00'\nGROUP BY ap.Name\nHAVING COUNT(sc.SecurityCheckID) > 2;"
        },
        {
            "question": "Какие авиакомпании имеют более 2 неуспешных проверок безопасности?",
            "sql_query": "SELECT al.Name AS AirlineName, COUNT(sc.SecurityCheckID) AS TotalSecurityChecks\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN SecurityCheck sc ON b.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Не прошел'\nGROUP BY al.Name\nHAVING COUNT(sc.SecurityCheckID) > 2;"
        },
        {
            "question": "Какие пассажиры имеют средний вес принятого багажа более 15 кг?",
            "sql_query": "SELECT p.FirstName, p.LastName, AVG(bg.WeightKG) AS AvgBaggageWeight\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Принято'\nGROUP BY p.FirstName, p.LastName\nHAVING AVG(bg.WeightKG) > 15;"
        },
        {
            "question": "Какие модели самолетов потеряли более 500 выручки от отмененных бронирований?",
            "sql_query": "SELECT a.Model, SUM(b.Price) AS TotalRevenue\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nWHERE b.Status = 'Отменено'\nGROUP BY a.Model\nHAVING SUM(b.Price) > 500;"
        },
        {
            "question": "Какие аэропорты имеют более 5 завершенных технических обслуживаний?",
            "sql_query": "SELECT ap.Name AS AirportName, COUNT(m.MaintenanceID) AS TotalMaintenances\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nGROUP BY ap.Name\nHAVING COUNT(m.MaintenanceID) > 5;"
        },
        {
            "question": "Какие модели самолетов имеют среднее время проверки безопасности после 20:00?",
            "sql_query": "SELECT a.Model, AVG(sc.CheckTime) AS AvgSecurityCheckTime\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN SecurityCheck sc ON b.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Прошел'\nGROUP BY a.Model\nHAVING AVG(CAST(sc.CheckTime AS TIME)) > '20:00:00';"
        },
        {
            "question": "Какие аэропорты имеют непринятый багаж?",
            "sql_query": "SELECT ap.Name AS AirportName, COUNT(bg.BaggageID) AS TotalBaggage\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Не принято'\nGROUP BY ap.Name\nHAVING COUNT(bg.BaggageID) > 0;"
        },
        {
            "question": "Какие пилоты имеют среднюю продолжительность рейса более 120 минут?",
            "sql_query": "SELECT p.FirstName, p.LastName, AVG(f.DurationMinutes) AS AvgFlightDuration\nFROM Pilot p\nJOIN Crew c ON p.PilotID = c.PilotID\nJOIN Flight f ON c.FlightID = f.FlightID\nWHERE f.Status = 'Запланирован'\nGROUP BY p.FirstName, p.LastName\nHAVING AVG(f.DurationMinutes) > 120;"
        },
        {
            "question": "Какие модели самолетов имеют более 5 успешных проверок безопасности?",
            "sql_query": "SELECT a.Model, COUNT(sc.SecurityCheckID) AS TotalSecurityChecks\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN SecurityCheck sc ON b.PassengerID = sc.PassengerID\nWHERE sc.Status = 'Прошел'\nGROUP BY a.Model\nHAVING COUNT(sc.SecurityCheckID) > 5;"
        },
        {
            "question": "Какие аэропорты имеют максимальную стоимость запланированного технического обслуживания более 10000?",
            "sql_query": "SELECT ap.Name AS AirportName, AVG(m.Cost) AS AvgMaintenanceCost\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Запланировано'\nGROUP BY ap.Name\nHAVING MAX(m.Cost) > 10000;"
        },
        {
            "question": "Какие авиакомпании имеют более 1 бортпроводника?",
            "sql_query": "SELECT al.Name AS AirlineName, COUNT(c.CrewID) AS TotalCrewMembers\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Crew c ON f.FlightID = c.FlightID\nWHERE c.Role = 'Бортпроводник'\nGROUP BY al.Name\nHAVING COUNT(c.CrewID) > 1;"
        },
        {
            "question": "Какие пассажиры имеют общий вес принятого багажа более 50 кг за 2023 год?",
            "sql_query": "SELECT p.FirstName, p.LastName, SUM(bg.WeightKG) AS TotalBaggageWeight\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Принято' AND YEAR(b.BookingDate) = 2023\nGROUP BY p.FirstName, p.LastName\nHAVING SUM(bg.WeightKG) > 50;"
        },
        {
            "question": "Какие модели самолетов имеют среднюю стоимость подтвержденного бронирования более 2000?",
            "sql_query": "SELECT a.Model, AVG(b.Price) AS AvgBookingPrice\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nWHERE b.Status = 'Подтверждено'\nGROUP BY a.Model\nHAVING AVG(b.Price) > 2000;"
        },
        {
            "question": "Какие аэропорты имеют более 2 пилотов с опытом работы более 10 лет?",
            "sql_query": "SELECT ap.Name AS AirportName, COUNT(p.PilotID) AS TotalPilots\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Crew c ON f.FlightID = c.FlightID\nJOIN Pilot p ON c.PilotID = p.PilotID\nWHERE p.ExperienceYears > 10\nGROUP BY ap.Name\nHAVING COUNT(p.PilotID) > 2;"
        },
        {
            "question": "Какие авиакомпании имеют среднюю продолжительность рейса более 150 минут?",
            "sql_query": "SELECT al.Name AS AirlineName, AVG(f.DurationMinutes) AS AvgFlightDuration\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nWHERE f.Status = 'Запланирован'\nGROUP BY al.Name\nHAVING AVG(f.DurationMinutes) > 150;"
        },
        {
            "question": "Какие пассажиры имеют более 1 запланированного рейса?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(f.FlightID) AS TotalFlights\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Flight f ON b.FlightID = f.FlightID\nWHERE f.Status = 'Запланирован'\nGROUP BY p.FirstName, p.LastName\nHAVING COUNT(f.FlightID) > 1;"
        },
        {
            "question": "Какие модели самолетов имеют общий вес принятого багажа более 100 кг?",
            "sql_query": "SELECT a.Model, SUM(bg.WeightKG) AS TotalBaggageWeight\nFROM Aircraft a\nJOIN Flight f ON a.AircraftID = f.AircraftID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Принято'\nGROUP BY a.Model\nHAVING SUM(bg.WeightKG) > 100;"
        },
        {
            "question": "Какие аэропорты имеют среднюю стоимость подтвержденного бронирования более 1500?",
            "sql_query": "SELECT ap.Name AS AirportName, AVG(b.Price) AS AvgBookingPrice\nFROM Airport ap\nJOIN Flight f ON ap.AirportID = f.DepartureAirportID\nJOIN Booking b ON f.FlightID = b.FlightID\nWHERE b.Status = 'Подтверждено'\nGROUP BY ap.Name\nHAVING AVG(b.Price) > 1500;"
        },
        {
            "question": "Какие рейсы имеют продолжительность более 120 минут и выполняются самолетами с вместимостью более 150 пассажиров? Нужна подробная информация о рейсе и самолете",
            "sql_query": "SELECT \n    f.FlightNumber,\n    a.Model,\n    al.Name AS AirlineName,\n    dep.Name AS DepartureAirport,\n    arr.Name AS ArrivalAirport,\n    f.DurationMinutes\nFROM Flight f\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nJOIN Airline al ON f.AirlineID = al.AirlineID\nJOIN Airport dep ON f.DepartureAirportID = dep.AirportID\nJOIN Airport arr ON f.ArrivalAirportID = arr.AirportID\nWHERE f.DurationMinutes > 120 \nAND a.Capacity > 150\nORDER BY f.DurationMinutes DESC;"
        },
        {
            "question": "Какие пассажиры летали более чем с одной авиакомпанией?",
            "sql_query": "SELECT \n    p.FirstName,\n    p.LastName,\n    COUNT(DISTINCT f.AirlineID) AS DifferentAirlines\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Flight f ON b.FlightID = f.FlightID\nGROUP BY p.PassengerID, p.FirstName, p.LastName\nHAVING COUNT(DISTINCT f.AirlineID) > 1\nORDER BY DifferentAirlines DESC;"
        },
        {
            "question": "Какие аэропорты обслуживают международные рейсы? В ответе укажите название аэропорта, город, страну и количество международных рейсов.",
            "sql_query": "SELECT \n    a.Name AS AirportName,\n    a.City,\n    a.Country,\n    COUNT(DISTINCT f.FlightID) AS InternationalFlights\nFROM Airport a\nJOIN Flight f ON a.AirportID = f.DepartureAirportID\nJOIN Airport arr ON f.ArrivalAirportID = arr.AirportID\nWHERE a.Country != arr.Country\nGROUP BY a.AirportID, a.Name, a.City, a.Country\nORDER BY InternationalFlights DESC;"
        },
        {
            "question": "Какие самолеты имеют более 1 технического обслуживания? В ответе укажите модель самолета, регистрационный номер, количество обслуживаний и общую стоимость обслуживания.",
            "sql_query": "SELECT \n    a.Model,\n    a.RegistrationNumber,\n    COUNT(m.MaintenanceID) AS MaintenanceCount,\n    SUM(m.Cost) AS TotalMaintenanceCost\nFROM Aircraft a\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nGROUP BY a.AircraftID, a.Model, a.RegistrationNumber\nHAVING COUNT(m.MaintenanceID) > 1\nORDER BY MaintenanceCount DESC;"
        },
        {
            "question": "Какие топ-10 маршруты имеют самые дорогие билеты? В ответе укажите аэропорты вылета и прилета, среднюю стоимость билета и общее количество билетов.",
            "sql_query": "SELECT \n    dep.Name AS DepartureAirport,\n    arr.Name AS ArrivalAirport,\n    AVG(t.Price) AS AverageTicketPrice,\n    COUNT(t.TicketID) AS TotalTickets\nFROM Route r\nJOIN Airport dep ON r.DepartureAirportID = dep.AirportID\nJOIN Airport arr ON r.ArrivalAirportID = arr.AirportID\nJOIN Flight f ON r.RouteID = f.FlightID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN Ticket t ON b.BookingID = t.BookingID\nGROUP BY r.RouteID, dep.Name, arr.Name\nORDER BY AverageTicketPrice DESC LIMIT 10;"
        },
        {
            "question": "Какие 30 пилотов выполнили самые длинные маршруты? В ответе укажите имя, фамилию пилота, максимальное расстояние маршрута и количество различных маршрутов.",
            "sql_query": "SELECT \n    p.FirstName,\n    p.LastName,\n    MAX(r.DistanceKM) AS LongestRouteDistance,\n    COUNT(DISTINCT r.RouteID) AS DifferentRoutes\nFROM Pilot p\nJOIN Crew c ON p.PilotID = c.PilotID\nJOIN Flight f ON c.FlightID = f.FlightID\nJOIN Route r ON f.FlightID = r.RouteID\nGROUP BY p.PilotID, p.FirstName, p.LastName\nORDER BY LongestRouteDistance DESC LIMIT 30;"
        },
        {
            "question": "Какие топ-10 авиакомпаний используют наибольшее количество различных моделей самолетов? В ответе укажите название авиакомпании, количество различных моделей самолетов и количество различных производителей.",
            "sql_query": "SELECT \n    al.Name AS AirlineName,\n    COUNT(DISTINCT a.Model) AS DifferentAircraftModels,\n    COUNT(DISTINCT a.Manufacturer) AS DifferentManufacturers\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nGROUP BY al.AirlineID, al.Name\nORDER BY DifferentAircraftModels DESC LIMIT 10;"
        },
        {
            "question": "Какие рейсы перевозят наибольшее количество пассажиров? В ответе укажите номер рейса, аэропорты вылета и прилета, общее количество пассажиров и среднюю стоимость билета.",
            "sql_query": "SELECT \n    f.FlightNumber,\n    dep.Name AS DepartureAirport,\n    arr.Name AS ArrivalAirport,\n    COUNT(b.PassengerID) AS TotalPassengers,\n    AVG(t.Price) AS AverageTicketPrice\nFROM Flight f\nJOIN Airport dep ON f.DepartureAirportID = dep.AirportID\nJOIN Airport arr ON f.ArrivalAirportID = arr.AirportID\nJOIN Booking b ON f.FlightID = b.FlightID\nJOIN Ticket t ON b.BookingID = t.BookingID\nGROUP BY f.FlightID, f.FlightNumber, dep.Name, arr.Name\nORDER BY TotalPassengers DESC;"
        },
        {
            "question": "Какие авиакомпании имеют среднюю стоимость технического обслуживания более 20000?",
            "sql_query": "SELECT \n    al.Name AS AirlineName,\n    AVG(m.Cost) AS AverageMaintenanceCost\nFROM Airline al\nJOIN Flight f ON al.AirlineID = f.AirlineID\nJOIN Aircraft a ON f.AircraftID = a.AircraftID\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nGROUP BY al.Name\nHAVING AVG(m.Cost) > 20000\nORDER BY AverageMaintenanceCost DESC;"
        },
        {
            "question": "Какие пассажиры имеют общий вес принятого багажа более 100 кг?",
            "sql_query": "SELECT \n    p.FirstName,\n    p.LastName,\n    SUM(bg.WeightKG) AS TotalBaggageWeight\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Baggage bg ON b.BookingID = bg.BookingID\nWHERE bg.Status = 'Принято'\nGROUP BY p.FirstName, p.LastName\nHAVING SUM(bg.WeightKG) > 100\nORDER BY TotalBaggageWeight DESC;"
        },
        {
            "question": "Какие топ-5 аэропорты имеют наибольшее количество международных вылетов до 12:00? В ответе укажите название аэропорта вылета и количество международных вылетов.",
            "sql_query": "SELECT\n    dep.Name AS DepartureAirport,\n    COUNT(DISTINCT f.FlightID) AS InternationalDepartures\nFROM Airport dep\nJOIN Flight f ON dep.AirportID = f.DepartureAirportID\nJOIN Airport arr ON f.ArrivalAirportID = arr.AirportID\nWHERE dep.Country != arr.Country\nAND TIME(f.ScheduledDeparture) < '12:00:00'\nGROUP BY dep.AirportID, dep.Name\nORDER BY InternationalDepartures DESC\nLIMIT 5;"
        },
        {
            "question": "Какие топ-5 пассажиры преодолели наибольшее расстояние в подтвержденных рейсах?",
            "sql_query": "SELECT \n    p.FirstName,\n    p.LastName,\n    SUM(r.DistanceKM) AS TotalDistanceTraveled\nFROM Passenger p\nJOIN Booking b ON p.PassengerID = b.PassengerID\nJOIN Flight f ON b.FlightID = f.FlightID\nJOIN Route r ON f.FlightID = r.RouteID\nWHERE b.Status = 'Подтверждено'\nGROUP BY p.PassengerID, p.FirstName, p.LastName\nORDER BY TotalDistanceTraveled DESC\nLIMIT 5;"
        },
        {
            "question": "Какие топ-5 модели самолетов имеют наибольшую общую стоимость технического обслуживания за последние 2 года?",
            "sql_query": "SELECT \n    a.Model,\n    SUM(m.Cost) AS TotalMaintenanceCost\nFROM Aircraft a\nJOIN Maintenance m ON a.AircraftID = m.AircraftID\nWHERE m.Status = 'Завершено'\nAND m.Date >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR)\nGROUP BY a.Model\nORDER BY TotalMaintenanceCost DESC\nLIMIT 5;"
        }
    ]
}
