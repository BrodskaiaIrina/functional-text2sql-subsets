{
    "queries": [
        {
            "question": "В каких судах, где дела находятся на рассмотрении, работают более одного судьи?",
            "sql_query": "SELECT c.CourtName, COUNT(DISTINCT j.JudgeID) AS TotalJudges FROM Court c JOIN Judge j ON c.CourtID = j.CourtID JOIN `Cases` cs ON c.CourtID = cs.CourtID WHERE cs.Status = 'На рассмотрении' GROUP BY c.CourtName HAVING COUNT(DISTINCT j.JudgeID) > 1;"
        },
        {
            "question": "Какие юридические фирмы имеют средний опыт адвокатов более 5 лет и работают с юридическими лицами?",
            "sql_query": "SELECT lf.FirmName, AVG(l.ExperienceYears) AS AvgExperience FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Client cl ON ct.ClientID = cl.ClientID WHERE cl.ClientType = 'Юридическое лицо' GROUP BY lf.FirmName HAVING AVG(l.ExperienceYears) > 5;"
        },
        {
            "question": "Какие женщины-клиенты имеют общую сумму платежей более пяти тысяч?",
            "sql_query": "SELECT p.FirstName, p.LastName, SUM(pmt.Amount) AS TotalPayments FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE p.Gender = 'Ж' GROUP BY p.FirstName, p.LastName HAVING SUM(pmt.Amount) > 5000;"
        },
        {
            "question": "В каких судах рассмотрено более 2 уголовных дел?",
            "sql_query": "SELECT c.CourtName, COUNT(DISTINCT v.VerdictID) AS TotalVerdicts FROM Court c JOIN `Cases` cs ON c.CourtID = cs.CourtID JOIN Verdict v ON cs.CaseID = v.CaseID WHERE v.VerdictType = 'Уголовное Дело' GROUP BY c.CourtName HAVING COUNT(DISTINCT v.VerdictID) > 2;"
        },
        {
            "question": "Какие специализации адвокатов имеют более 1 контракта с клиентами, зарегистрированными после 2023-01-01?",
            "sql_query": "SELECT l.Specialization, COUNT(DISTINCT ct.ContractID) AS TotalContracts FROM Lawyer l JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Client cl ON ct.ClientID = cl.ClientID WHERE cl.RegistrationDate > '2023-01-01' GROUP BY l.Specialization HAVING COUNT(DISTINCT ct.ContractID) > 1;"
        },
        {
            "question": "Какие лица подали более 1 апелляции по закрытым делам?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT a.AppealID) AS TotalAppeals FROM Person p JOIN Appeal a ON p.PersonID = a.AppellantID JOIN `Cases` c ON a.CaseID = c.CaseID WHERE c.Status = 'Закрыто' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT a.AppealID) > 1;"
        },
        {
            "question": "В каких судах средний опыт судей по административным делам превышает 10 лет?",
            "sql_query": "SELECT c.CourtName, AVG(j.ExperienceYears) AS AvgJudgeExperience FROM Court c JOIN Judge j ON c.CourtID = j.CourtID JOIN `Cases` cs ON c.CourtID = cs.CourtID WHERE cs.CaseType = 'Административное дело' GROUP BY c.CourtName HAVING AVG(j.ExperienceYears) > 10;"
        },
        {
            "question": "Какие клиенты имеют более 1 документа типа 'Документ' в качестве доказательства?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Evidence e ON ct.ClientID = e.CaseID WHERE e.EvidenceType = 'Документ' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT e.EvidenceID) > 1;"
        },
        {
            "question": "Какие юридические фирмы проводили консультации по семейному праву?",
            "sql_query": "SELECT lf.FirmName, COUNT(DISTINCT la.AdviceID) AS TotalAdvice FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN LegalAdvice la ON l.LawyerID = la.LawyerID WHERE la.AdviceType = 'Семейное право' GROUP BY lf.FirmName HAVING COUNT(DISTINCT la.AdviceID) > 0;"
        },
        {
            "question": "Какие юридические фирмы имеют более 1 видео в качестве доказательства?",
            "sql_query": "SELECT lf.FirmName, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Evidence e ON ct.ClientID = e.CaseID WHERE e.EvidenceType = 'Видео' GROUP BY lf.FirmName HAVING COUNT(DISTINCT e.EvidenceID) > 1;"
        },
        {
            "question": "В каких судах общая сумма платежей по кредитным картам превышает 50,000?",
            "sql_query": "SELECT c.CourtName, SUM(pmt.Amount) AS TotalPayments FROM Court c JOIN `Cases` cs ON c.CourtID = cs.CourtID JOIN Contract ct ON cs.CaseID = ct.ClientID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE pmt.PaymentMethod = 'Кредитная карта' GROUP BY c.CourtName HAVING SUM(pmt.Amount) > 50000;"
        },
        {
            "question": "Какие клиенты имеют решение суда в качестве документа и сколько?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT ld.DocumentID) AS TotalDocuments FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID WHERE ld.DocumentType = 'Решение суда' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT ld.DocumentID) > 0;"
        },
        {
            "question": "В каких судах находится на рассмотрении более 1 апелляции?",
            "sql_query": "SELECT c.CourtName, COUNT(DISTINCT a.AppealID) AS TotalAppeals FROM Court c JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Appeal a ON cs.CaseID = a.CaseID WHERE a.AppealStatus = 'В ожидании' GROUP BY c.CourtName HAVING COUNT(DISTINCT a.AppealID) > 1;"
        },
        {
            "question": "В каких судах средняя сумма платежей наличными превышает 1500?",
            "sql_query": "SELECT c.CourtName, AVG(pmt.Amount) AS AvgPaymentAmount FROM Court c JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Contract ct ON cs.CaseID = ct.ClientID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE pmt.PaymentMethod = 'Наличные' GROUP BY c.CourtName HAVING AVG(pmt.Amount) > 1500;"
        },
        {
            "question": "Какие клиенты имеют более 1 консультации по трудовому праву?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT la.AdviceID) AS TotalAdvice FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN LegalAdvice la ON cl.ClientID = la.ClientID WHERE la.AdviceType = 'Трудовое право' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT la.AdviceID) > 1;"
        },
        {
            "question": "В каких судах имеется более 1 отчета в качестве доказательства?",
            "sql_query": "SELECT c.CourtName, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM Court c JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Evidence e ON cs.CaseID = e.CaseID WHERE e.EvidenceType = 'Отчет' GROUP BY c.CourtName HAVING COUNT(DISTINCT e.EvidenceID) > 1;"
        },
        {
            "question": "Какие юридические фирмы имеют более 1 консультации по интеллектуальной собственности?",
            "sql_query": "SELECT lf.FirmName, COUNT(DISTINCT la.AdviceID) AS TotalAdvice FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN LegalAdvice la ON l.LawyerID = la.LawyerID WHERE la.AdviceType = 'Интеллектуальная собственность' GROUP BY lf.FirmName HAVING COUNT(DISTINCT la.AdviceID) > 1;"
        },
        {
            "question": "Какие клиенты имеют более 1 удовлетворенной апелляции?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT a.AppealID) AS TotalAppeals FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Appeal a ON cl.ClientID = a.CaseID WHERE a.AppealStatus = 'Принято' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT a.AppealID) > 1;"
        },
        {
            "question": "Какие юридические фирмы имеют общую сумму платежей через банковский перевод более 60,000?",
            "sql_query": "SELECT lf.FirmName, SUM(pmt.Amount) AS TotalPayments FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE pmt.PaymentMethod = 'Банковский перевод' GROUP BY lf.FirmName HAVING SUM(pmt.Amount) > 60000;"
        },
        {
            "question": "В каких судах имеются протоколы судебного заседания и сколько?",
            "sql_query": "SELECT c.CourtName, COUNT(DISTINCT ld.DocumentID) AS TotalDocuments FROM Court c JOIN Cases cs ON c.CourtID = cs.CourtID JOIN LegalDocument ld ON cs.CaseID = ld.CaseID WHERE ld.DocumentType = 'Протокол судебного заседания' GROUP BY c.CourtName HAVING COUNT(DISTINCT ld.DocumentID) > 0;"
        },
        {
            "question": "Какие специализации адвокатов имеют более 1 консультации по административному праву?",
            "sql_query": "SELECT l.Specialization, COUNT(DISTINCT la.AdviceID) AS TotalAdvice FROM Lawyer l JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN LegalAdvice la ON ct.ClientID = la.ClientID WHERE la.AdviceType = 'Административное право' GROUP BY l.Specialization HAVING COUNT(DISTINCT la.AdviceID) > 1;"
        },
        {
            "question": "Какие клиенты имеют более 1 видео в качестве доказательства?",
            "sql_query": "SELECT p.FirstName, p.LastName, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Evidence e ON ct.ClientID = e.CaseID WHERE e.EvidenceType = 'Видео' GROUP BY p.FirstName, p.LastName HAVING COUNT(DISTINCT e.EvidenceID) > 1;"
        },
        {
            "question": "Какие топ-5 судей с опытом более 8 лет рассматривали дела с общим количеством доказательств более 2, включая видео и документы, за последние 3 месяца? (отсортировано по количеству доказательств)",
            "sql_query": "SELECT DISTINCT p.FirstName, p.LastName, j.ExperienceYears, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM Judge j JOIN Person p ON j.PersonID = p.PersonID JOIN Cases cs ON j.CourtID = cs.CourtID JOIN Evidence e ON cs.CaseID = e.CaseID WHERE j.ExperienceYears > 8 AND e.EvidenceType IN ('Видео', 'Документ') AND e.SubmissionDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) GROUP BY p.FirstName, p.LastName, j.ExperienceYears HAVING COUNT(DISTINCT e.EvidenceID) > 2 ORDER BY TotalEvidence DESC LIMIT 5;"
        },
        {
            "question": "Какие топ-4 клиента, зарегистрированные в 2023 году, имеют дела с более чем одним типом доказательств и общим количеством документов более 2? (отсортировано по количеству документов)",
            "sql_query": "SELECT p.FirstName, p.LastName, cl.RegistrationDate, COUNT(DISTINCT e.EvidenceType) AS EvidenceTypes, COUNT(DISTINCT ld.DocumentID) AS TotalDocuments FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Evidence e ON ct.ClientID = e.CaseID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID WHERE YEAR(cl.RegistrationDate) = 2023 GROUP BY p.FirstName, p.LastName, cl.RegistrationDate HAVING COUNT(DISTINCT e.EvidenceType) > 1 AND COUNT(DISTINCT ld.DocumentID) > 2 ORDER BY TotalDocuments DESC LIMIT 4;"
        },
        {
            "question": "В каких топ-3 судах рассматриваются дела с апелляциями, где средний опыт судей превышает 10 лет, и количество разбирательств более 1? (отсортировано по количеству апелляций)",
            "sql_query": "SELECT c.CourtName, AVG(j.ExperienceYears) AS AvgJudgeExperience, COUNT(DISTINCT h.HearingID) AS TotalHearings, COUNT(DISTINCT a.AppealID) AS TotalAppeals FROM Court c JOIN Judge j ON c.CourtID = j.CourtID JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Hearing h ON cs.CaseID = h.CaseID JOIN Appeal a ON cs.CaseID = a.CaseID WHERE h.HearingType = 'Разбирательство' GROUP BY c.CourtName HAVING AVG(j.ExperienceYears) > 10 AND COUNT(DISTINCT h.HearingID) > 1 ORDER BY TotalAppeals DESC LIMIT 3;"
        },
        {
            "question": "Какие топ-4 адвоката с опытом более 5 лет работают над делами с общим количеством платежей более 3 и суммарной стоимостью более 15000, включая дела с разными типами документов? (отсортировано по общей сумме платежей)",
            "sql_query": "SELECT p.FirstName, p.LastName, l.ExperienceYears, l.Specialization, COUNT(DISTINCT pmt.PaymentID) AS TotalPayments, SUM(pmt.Amount) AS TotalAmount, COUNT(DISTINCT ld.DocumentType) AS DocumentTypes FROM Person p JOIN Lawyer l ON p.PersonID = l.PersonID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID WHERE l.ExperienceYears > 5 GROUP BY p.FirstName, p.LastName, l.ExperienceYears, l.Specialization HAVING COUNT(DISTINCT pmt.PaymentID) > 3 AND SUM(pmt.Amount) > 15000 AND COUNT(DISTINCT ld.DocumentType) > 1 ORDER BY TotalAmount DESC LIMIT 4;"
        },
        {
            "question": "Какие топ-5 судей с опытом более 8 лет рассматривали дела с общим количеством доказательств более 2, включая видео и документы, за последние 3 месяца? (отсортировано по количеству доказательств)",
            "sql_query": "SELECT DISTINCT p.FirstName, p.LastName, j.ExperienceYears, COUNT(DISTINCT e.EvidenceID) AS TotalEvidence FROM Judge j JOIN Person p ON j.PersonID = p.PersonID JOIN Cases cs ON j.CourtID = cs.CourtID JOIN Evidence e ON cs.CaseID = e.CaseID WHERE j.ExperienceYears > 8 AND e.EvidenceType IN ('Видео', 'Документ') AND e.SubmissionDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) GROUP BY p.FirstName, p.LastName, j.ExperienceYears HAVING COUNT(DISTINCT e.EvidenceID) > 2 ORDER BY TotalEvidence DESC LIMIT 5;"
        },
        {
            "question": "Какие топ-4 клиента, зарегистрированные в 2023 году, имеют дела с более чем одним типом доказательств и общим количеством документов более 2? (отсортировано по количеству документов)",
            "sql_query": "SELECT p.FirstName, p.LastName, cl.RegistrationDate, COUNT(DISTINCT e.EvidenceType) AS EvidenceTypes, COUNT(DISTINCT ld.DocumentID) AS TotalDocuments FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Evidence e ON ct.ClientID = e.CaseID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID WHERE YEAR(cl.RegistrationDate) = 2023 GROUP BY p.FirstName, p.LastName, cl.RegistrationDate HAVING COUNT(DISTINCT e.EvidenceType) > 1 AND COUNT(DISTINCT ld.DocumentID) > 2 ORDER BY TotalDocuments DESC LIMIT 4;"
        },
        {
            "question": "В каких топ-3 судах рассматриваются дела с апелляциями, где средний опыт судей превышает 10 лет, и количество разбирательств более 1? (отсортировано по количеству апелляций)",
            "sql_query": "SELECT c.CourtName, AVG(j.ExperienceYears) AS AvgJudgeExperience, COUNT(DISTINCT h.HearingID) AS TotalHearings, COUNT(DISTINCT a.AppealID) AS TotalAppeals FROM Court c JOIN Judge j ON c.CourtID = j.CourtID JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Hearing h ON cs.CaseID = h.CaseID JOIN Appeal a ON cs.CaseID = a.CaseID WHERE h.HearingType = 'Разбирательство' GROUP BY c.CourtName HAVING AVG(j.ExperienceYears) > 10 AND COUNT(DISTINCT h.HearingID) > 1 ORDER BY TotalAppeals DESC LIMIT 3;"
        },
        {
            "question": "Какие топ-4 адвоката с опытом более 5 лет работают над делами с общим количеством платежей более 3 и суммарной стоимостью более 15000, включая дела с разными типами документов? (отсортировано по общей сумме платежей)",
            "sql_query": "SELECT p.FirstName, p.LastName, l.ExperienceYears, l.Specialization, COUNT(DISTINCT pmt.PaymentID) AS TotalPayments, SUM(pmt.Amount) AS TotalAmount, COUNT(DISTINCT ld.DocumentType) AS DocumentTypes FROM Person p JOIN Lawyer l ON p.PersonID = l.PersonID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID WHERE l.ExperienceYears > 5 GROUP BY p.FirstName, p.LastName, l.ExperienceYears, l.Specialization HAVING COUNT(DISTINCT pmt.PaymentID) > 3 AND SUM(pmt.Amount) > 15000 AND COUNT(DISTINCT ld.DocumentType) > 1 ORDER BY TotalAmount DESC LIMIT 4;"
        },
        {
            "question": "Какие топ-5 судей с опытом более 7 лет рассматривали дела с апелляциями, где сумма платежей превышает 8000, и количество разбирательств более 2? (отсортировано по общей сумме платежей)",
            "sql_query": "SELECT DISTINCT p.FirstName, p.LastName, j.ExperienceYears, COUNT(DISTINCT h.HearingID) AS TotalHearings, SUM(pmt.Amount) AS TotalPayments FROM Judge j JOIN Person p ON j.PersonID = p.PersonID JOIN Cases cs ON j.CourtID = cs.CourtID JOIN Hearing h ON cs.CaseID = h.CaseID JOIN Contract ct ON cs.CaseID = ct.ClientID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE j.ExperienceYears > 7 AND h.HearingType = 'Разбирательство' GROUP BY p.FirstName, p.LastName, j.ExperienceYears HAVING COUNT(DISTINCT h.HearingID) > 2 AND SUM(pmt.Amount) > 8000 ORDER BY TotalPayments DESC LIMIT 5;"
        },
        {
            "question": "Какие топ-5 адвокатов с опытом более 6 лет работают над делами с более чем 2 типами доказательств и общим количеством платежей более 4, включая дела с разными типами документов и консультациями? (отсортировано по количеству платежей)",
            "sql_query": "SELECT p.FirstName, p.LastName, l.ExperienceYears, l.Specialization, COUNT(DISTINCT e.EvidenceType) AS EvidenceTypes, COUNT(DISTINCT pmt.PaymentID) AS TotalPayments, COUNT(DISTINCT ld.DocumentType) AS DocumentTypes, COUNT(DISTINCT la.AdviceID) AS TotalAdvice FROM Person p JOIN Lawyer l ON p.PersonID = l.PersonID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Evidence e ON ct.ClientID = e.CaseID JOIN Payment pmt ON ct.ContractID = pmt.ContractID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID JOIN LegalAdvice la ON l.LawyerID = la.LawyerID WHERE l.ExperienceYears > 6 GROUP BY p.FirstName, p.LastName, l.ExperienceYears, l.Specialization HAVING COUNT(DISTINCT e.EvidenceType) > 2 AND COUNT(DISTINCT pmt.PaymentID) > 4 AND COUNT(DISTINCT ld.DocumentType) > 1 ORDER BY TotalPayments DESC LIMIT 5;"
        },
        {
            "question": "Найдите топ-7 судей, которые рассмотрели наибольшее количество гражданских дел за последние 2 года, имеющих более 3 документов и минимум 2 разбирательства, отсортированных по дате назначения судьи",
            "sql_query": "SELECT p.FirstName, p.LastName, j.AppointmentDate, COUNT(DISTINCT cs.CaseID) AS TotalCases, COUNT(DISTINCT ld.DocumentID) AS TotalDocuments, COUNT(DISTINCT h.HearingID) AS TotalHearings FROM Judge j JOIN Person p ON j.PersonID = p.PersonID JOIN Hearing h ON j.JudgeID = h.JudgeID JOIN Cases cs ON h.CaseID = cs.CaseID JOIN LegalDocument ld ON cs.CaseID = ld.CaseID WHERE cs.CaseType = 'Гражданское дело' AND cs.FilingDate >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY p.FirstName, p.LastName, j.AppointmentDate HAVING COUNT(DISTINCT ld.DocumentID) > 3 AND COUNT(DISTINCT h.HearingID) >= 2 ORDER BY j.AppointmentDate, TotalCases DESC LIMIT 7;"
        },
        {
            "question": "Определите топ-6 адвокатов из юридических фирм, основанных до 2005 года, которые вели дела с отклоненными апелляциями и общей суммой платежей более 7000, отсортированных по соотношению успешных решений к общему количеству дел",
            "sql_query": "SELECT p.FirstName, p.LastName, lf.FirmName, lf.EstablishedYear, SUM(pmt.Amount) AS TotalPayments, COUNT(DISTINCT v.VerdictID) AS SuccessfulVerdicts, COUNT(DISTINCT cs.CaseID) AS TotalCases, (COUNT(DISTINCT v.VerdictID) / COUNT(DISTINCT cs.CaseID)) AS SuccessRatio FROM Lawyer l JOIN Person p ON l.PersonID = p.PersonID JOIN LawFirm lf ON l.LawFirmID = lf.LawFirmID JOIN Cases cs ON l.LawyerID = cs.LawyerID JOIN Appeal a ON cs.CaseID = a.CaseID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID LEFT JOIN Verdict v ON cs.CaseID = v.CaseID WHERE lf.EstablishedYear < 2005 AND a.AppealStatus = 'Отказано' GROUP BY p.FirstName, p.LastName, lf.FirmName, lf.EstablishedYear HAVING SUM(pmt.Amount) > 7000 ORDER BY SuccessRatio DESC, TotalPayments DESC LIMIT 6;"
        },
        {
            "question": "Выявите топ-5 судов с наибольшим процентом удовлетворенных апелляций по уголовным делам, где сумма платежей адвокатам превышает 12000 и имеется более 3 типов доказательств, отсортированных по проценту удовлетворенных апелляций",
            "sql_query": "SELECT c.CourtName, c.CourtType, COUNT(DISTINCT CASE WHEN a.AppealStatus = 'Принято' THEN a.AppealID END) AS AcceptedAppeals, COUNT(DISTINCT a.AppealID) AS TotalAppeals, (COUNT(DISTINCT CASE WHEN a.AppealStatus = 'Принято' THEN a.AppealID END) / COUNT(DISTINCT a.AppealID) * 100) AS AcceptanceRate, SUM(pmt.Amount) AS TotalPayments, COUNT(DISTINCT e.EvidenceType) AS EvidenceTypes FROM Court c JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Appeal a ON cs.CaseID = a.CaseID JOIN Verdict v ON cs.CaseID = v.CaseID JOIN Evidence e ON cs.CaseID = e.CaseID JOIN Contract ct ON cs.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID WHERE v.VerdictType = 'Уголовное Дело' GROUP BY c.CourtName, c.CourtType HAVING SUM(pmt.Amount) > 12000 AND COUNT(DISTINCT e.EvidenceType) > 3 ORDER BY AcceptanceRate DESC, TotalPayments DESC LIMIT 5;"
        },
        {
            "question": "Определите топ-4 юридические фирмы, чьи адвокаты имеют наивысшее соотношение успешных дел к общему количеству дел, с минимальным опытом адвокатов более 5 лет и наличием специализации в корпоративном или интеллектуальном праве, отсортированных по году основания фирмы",
            "sql_query": "SELECT lf.FirmName, lf.EstablishedYear, AVG(l.ExperienceYears) AS AvgExperience, COUNT(DISTINCT CASE WHEN v.Details LIKE '%в пользу%' OR v.Details LIKE '%удовлетворено%' THEN v.VerdictID END) AS SuccessfulCases, COUNT(DISTINCT v.VerdictID) AS TotalCases, (COUNT(DISTINCT CASE WHEN v.Details LIKE '%в пользу%' OR v.Details LIKE '%удовлетворено%' THEN v.VerdictID END) / COUNT(DISTINCT v.VerdictID) * 100) AS SuccessRate FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN Cases cs ON l.LawyerID = cs.LawyerID JOIN Verdict v ON cs.CaseID = v.CaseID WHERE l.Specialization IN ('Корпоративное право', 'Интеллектуальная собственность') GROUP BY lf.FirmName, lf.EstablishedYear HAVING AVG(l.ExperienceYears) > 5 ORDER BY lf.EstablishedYear, SuccessRate DESC LIMIT 4;"
        },
        {
            "question": "Определите топ-9 самых разнообразных наборов доказательств по налоговым преступлениям, с указанием дел, имеющих не менее 3 различных типов доказательств, у которых срок между подачей и последним слушанием превышает 90 дней, отсортированных по количеству различных типов доказательств",
            "sql_query": "SELECT cs.CaseNumber, cs.CaseType, cs.FilingDate, MAX(h.HearingDate) AS LastHearingDate, DATEDIFF(MAX(h.HearingDate), cs.FilingDate) AS DaysInProcess, COUNT(DISTINCT e.EvidenceType) AS UniqueEvidenceTypes, GROUP_CONCAT(DISTINCT e.EvidenceType ORDER BY e.EvidenceType SEPARATOR ', ') AS EvidenceList FROM Cases cs JOIN Evidence e ON cs.CaseID = e.CaseID JOIN Hearing h ON cs.CaseID = h.CaseID WHERE cs.CaseType = 'Налоговое преступление' GROUP BY cs.CaseNumber, cs.CaseType, cs.FilingDate HAVING COUNT(DISTINCT e.EvidenceType) >= 3 AND DATEDIFF(MAX(h.HearingDate), cs.FilingDate) > 90 ORDER BY UniqueEvidenceTypes DESC, DaysInProcess DESC LIMIT 9;"
        },
        {
            "question": "Найдите топ-6 пар 'судья-адвокат', которые чаще всего работали вместе по делам с женщинами-клиентами за последние 2 года, где сумма платежей превышает 9000, и имеется не менее 2 разных типов документов, отсортированных по количеству совместных дел",
            "sql_query": "SELECT CONCAT(jp.FirstName, ' ', jp.LastName) AS JudgeName, CONCAT(lp.FirstName, ' ', lp.LastName) AS LawyerName, COUNT(DISTINCT cs.CaseID) AS CasesWorkedTogether, SUM(pmt.Amount) AS TotalPayments, COUNT(DISTINCT ld.DocumentType) AS DocumentTypes FROM Judge j JOIN Person jp ON j.PersonID = jp.PersonID JOIN Hearing h ON j.JudgeID = h.JudgeID JOIN Cases cs ON h.CaseID = cs.CaseID JOIN Lawyer l ON cs.LawyerID = l.LawyerID JOIN Person lp ON l.PersonID = lp.PersonID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Client cl ON ct.ClientID = cl.ClientID JOIN Person cp ON cl.PersonID = cp.PersonID JOIN Payment pmt ON ct.ContractID = pmt.ContractID JOIN LegalDocument ld ON cs.CaseID = ld.CaseID WHERE cp.Gender = 'Ж' AND cs.FilingDate >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY JudgeName, LawyerName HAVING COUNT(DISTINCT cs.CaseID) >= 1 AND SUM(pmt.Amount) > 9000 AND COUNT(DISTINCT ld.DocumentType) >= 2 ORDER BY CasesWorkedTogether DESC, TotalPayments DESC LIMIT 6;"
        },
        {
            "question": "Какие топ-8 городов (по адресам судов) имеют наиболее высокое соотношение успешных апелляций к общему количеству апелляций, с учетом опыта судей (не менее 10 лет), рассматривающих дела с минимум 3 разбирательствами, отсортированных по соотношению успешных апелляций",
            "sql_query": "SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(c.Address, ',', -2), ',', 1) AS City, COUNT(DISTINCT a.AppealID) AS TotalAppeals, COUNT(DISTINCT CASE WHEN a.AppealStatus = 'Принято' THEN a.AppealID END) AS SuccessfulAppeals, (COUNT(DISTINCT CASE WHEN a.AppealStatus = 'Принято' THEN a.AppealID END) / COUNT(DISTINCT a.AppealID) * 100) AS SuccessRate, AVG(j.ExperienceYears) AS AvgJudgeExperience, COUNT(DISTINCT h.HearingID) AS TotalHearings FROM Court c JOIN Judge j ON c.CourtID = j.CourtID JOIN Cases cs ON c.CourtID = cs.CourtID JOIN Appeal a ON cs.CaseID = a.CaseID JOIN Hearing h ON cs.CaseID = h.CaseID GROUP BY City HAVING AVG(j.ExperienceYears) >= 10 AND COUNT(DISTINCT h.HearingID) >= 3 ORDER BY SuccessRate DESC, TotalAppeals DESC LIMIT 8;"
        },
        {
            "question": "Какие топ-5 клиентов по среднему платежу на тип дела имеют не менее 2 дел каждого типа, и каков средний размер платежа, отсортированные по среднему платежу?",
            "sql_query": "SELECT p.FirstName, p.LastName, cs.CaseType, COUNT(DISTINCT cs.CaseID) AS CaseCount, AVG(pmt.Amount) AS AvgPayment FROM Person p JOIN Client cl ON p.PersonID = cl.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN Payment pmt ON ct.ContractID = pmt.ContractID JOIN Cases cs ON ct.ClientID = cs.CaseID GROUP BY p.FirstName, p.LastName, cs.CaseType HAVING COUNT(DISTINCT cs.CaseID) >= 2 ORDER BY AvgPayment DESC LIMIT 5;"
        },
        {
            "question": "Какие топ-4 специализации адвокатов имеют наибольшее количество закрытых дел и среднюю длину текста вердикта более 100 символов, отсортированные по количеству закрытых дел?",
            "sql_query": "SELECT l.Specialization, COUNT(DISTINCT cs.CaseID) AS ClosedCasesCount, AVG(CHAR_LENGTH(v.Details)) AS AvgVerdictLength FROM Lawyer l JOIN Cases cs ON l.LawyerID = cs.LawyerID JOIN Verdict v ON cs.CaseID = v.CaseID WHERE cs.Status = 'Закрыто' GROUP BY l.Specialization HAVING COUNT(DISTINCT cs.CaseID) > 1 AND AVG(CHAR_LENGTH(v.Details)) > 100 ORDER BY ClosedCasesCount DESC LIMIT 4;"
        },
        {
            "question": "Какие топ-6 клиентов по разнообразию типов документов имеют не менее 2 разных типов доказательств и период между первой и последней подачей документа более 30 дней, отсортированные по длине периода?",
            "sql_query": "SELECT p.FirstName, p.LastName, cl.ClientType, COUNT(DISTINCT ld.DocumentType) AS DocTypeCount, DATEDIFF(MAX(ld.DocumentDate), MIN(ld.DocumentDate)) AS DocSpanDays FROM Client cl JOIN Person p ON cl.PersonID = p.PersonID JOIN Contract ct ON cl.ClientID = ct.ClientID JOIN LegalDocument ld ON ct.ClientID = ld.CaseID GROUP BY p.FirstName, p.LastName, cl.ClientType HAVING COUNT(DISTINCT ld.DocumentType) >= 2 AND DATEDIFF(MAX(ld.DocumentDate), MIN(ld.DocumentDate)) > 30 ORDER BY DocSpanDays DESC LIMIT 6;"
        },
        {
            "question": "Какие топ-8 адвокатов имеют наименьшую среднюю задержку оплаты после заключения договора, при условии не менее 3 оплат на адвоката, отсортированные по времени задержки?",
            "sql_query": "SELECT p.FirstName, p.LastName, l.ExperienceYears, ROUND(AVG(DATEDIFF(pmt.PaymentDate, ct.ContractDate)),1) AS AvgPaymentDelay, COUNT(pmt.PaymentID) AS TotalPayments FROM Lawyer l JOIN Person p ON l.PersonID = p.PersonID JOIN Contract ct ON l.LawyerID = ct.LawyerID JOIN Payment pmt ON ct.ContractID = pmt.ContractID GROUP BY p.FirstName, p.LastName, l.ExperienceYears HAVING COUNT(pmt.PaymentID) >= 3 ORDER BY AvgPaymentDelay ASC LIMIT 8;"
        },
        {
            "question": "Какие топ-5 юридических фирм имеют наименьший средний срок вынесения вердиктов по экономическим делам за последние 12 месяцев при наличии более 3 таких вердиктов, отсортированных по среднему сроку (в днях)?",
            "sql_query": "SELECT lf.FirmName, COUNT(v.VerdictID) AS TotalEconVerdicts, ROUND(AVG(DATEDIFF(v.VerdictDate, cs.FilingDate)),1) AS AvgVerdictDelay FROM LawFirm lf JOIN Lawyer l ON lf.LawFirmID = l.LawFirmID JOIN Cases cs ON l.LawyerID = cs.LawyerID JOIN Verdict v ON cs.CaseID = v.CaseID WHERE v.VerdictType = 'Экономическое Дело' AND v.VerdictDate >= DATE_SUB(CURDATE(), INTERVAL 12 MONTH) GROUP BY lf.FirmName HAVING COUNT(v.VerdictID) > 3 ORDER BY AvgVerdictDelay ASC LIMIT 5;"
        },
        {
            "question": "Какие топ-7 способов оплаты имеют наиболее разнообразное применение по типам дел при средней сумме платежей более 1000 за последние 12 месяцев, отсортированных по количеству различных типов дел?",
            "sql_query": "SELECT pmt.PaymentMethod, COUNT(DISTINCT cs.CaseType) AS DistinctCaseTypes, ROUND(AVG(pmt.Amount),2) AS AvgPayment FROM Payment pmt JOIN Contract ct ON pmt.ContractID = ct.ContractID JOIN Cases cs ON ct.ClientID = cs.CaseID WHERE pmt.PaymentDate >= DATE_SUB(CURDATE(), INTERVAL 12 MONTH) GROUP BY pmt.PaymentMethod HAVING AVG(pmt.Amount) > 1000 ORDER BY DistinctCaseTypes DESC LIMIT 7;"
        }
    ]
}